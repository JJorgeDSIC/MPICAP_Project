
Atest = [
    0.7577,0.7060,0.8235,0.4387,0.4898
    0.7431,0.0318,0.6948,0.3816,0.4456
    0.3922,0.2769,0.3171,0.7655,0.6463
    0.6555,0.0462,0.9502,0.7952,0.7094
    0.1712,0.0971,0.0344,0.1869,0.7547]';

Btest = [
    0.8147    ,0.9058   ,0.1270   ,0.9134  ,0.6324
    0.0975   ,0.2785   ,0.5469  ,0.9575    ,0.9649
    0.1576   ,0.9706   ,0.9572  ,0.4854    ,0.8003
    0.1419   ,0.4218   ,0.9157  ,0.7922    ,0.9595
    0.6557   ,0.0357   ,0.8491  ,0.9340    ,0.6787]';

Ctest = [
    0.2760,0.4984,0.7513,0.9593,0.8407
    0.6797,0.9597,0.2551,0.5472,0.2543
    0.6551,0.3404,0.5060,0.1386,0.8143
    0.1626,0.5853,0.6991,0.1493,0.2435
    0.1190,0.2238,0.8909,0.2575,0.9293]';

QTQtrans=[0.814700,0.097500,0.157600,0.141900,0.655700
0.905800,0.278500,0.970600,0.421800,0.035700
0.127000,0.546900,0.957200,0.915700,0.849100
0.913400,0.957500,0.485400,0.792200,0.934000
0.632400,0.964900,0.800300,0.959500,0.678700];

[Q,T]=schur(Btest)

norm(Btest-QTQtrans, 'fro')
norm(Btest-Q*T*Q', 'fro')

D = Ctest*Q;

 Dtest=[-0.771321,0.270828,0.289263,-0.482836,-0.151116
 -1.032338,-0.233239,0.093128,-0.697889,-0.249234
 -1.370861,-0.384381,0.197796,0.064913,0.312507
 -0.687353,-0.462641,0.490560,-0.572415,0.269616
 -1.328979,-0.012919,0.501706,-0.020279,0.582193];

norm(D-Dtest, 'fro')